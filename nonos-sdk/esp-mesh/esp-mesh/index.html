<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:image" content="../../../img/logo.png"/>

  
  <meta name="author" content="Tuan PM">
  
  <title>ESP Mesh - Internet Of Things (IoT) với ESP8266</title>
  

  <link rel="shortcut icon" href="../../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../../css/highlight.css">

  <link rel="stylesheet" href="../../../css/custom.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "ESP Mesh";
    var mkdocs_page_input_path = "nonos-sdk/esp-mesh/esp-mesh.md";
    var mkdocs_page_url = "/nonos-sdk/esp-mesh/esp-mesh/";
  </script>
  
  <script src="../../../js/jquery-2.1.1.min.js"></script>
  <script src="../../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../../js/highlight.pack.js"></script>
  <script src="../../../js/theme.js"></script>
  <script src="../../../js/jquery.cookie-1.4.1.min.js"></script>
  <script src="../../../js/nav.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-60470603-4', 'esp8266.vn');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../.." class="icon icon-home"> Internet Of Things (IoT) với ESP8266</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../.." id="Trang chủ" style="font-size:95%;font-weight:bold;">Trang chủ</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="current">
        <a class="current"  id="Nội dung" style="font-size:95%;font-weight:bold;">Nội dung</a>
    </li>
    
        <li class="">
            <a style="padding-left:50px;" class=""  id="Kiến thức cơ bản" onclick="showChildren('Kiến thức cơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> Kiến thức cơ bản</a>
        </li>
        
        <div style="display:none" id="hidden_Kiến thức cơ bản">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/introduction/" id="Tổng quan">  Tổng quan </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quan">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/about-iot/" id="Internet Of Things (IoT)">  Internet Of Things (IoT) </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quanInternet Of Things (IoT)">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/about-esp8266/" id="ESP8266 & ESP8285">  ESP8266 & ESP8285 </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quanInternet Of Things (IoT)ESP8266 & ESP8285">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/esp-module/" id="Các loại Module">  Các loại Module </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quanInternet Of Things (IoT)ESP8266 & ESP8285Các loại Module">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/board/" id="Board phát triển">  Board phát triển </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quanInternet Of Things (IoT)ESP8266 & ESP8285Các loại ModuleBoard phát triển">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../introduction/prepare/" id="Phần cứng & công cụ">  Phần cứng & công cụ </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_Kiến thức cơ bảnTổng quanInternet Of Things (IoT)ESP8266 & ESP8285Các loại ModuleBoard phát triểnPhần cứng & công cụ">
            
            </div>
        
        </div>
    
        <li class="current">
            <a style="padding-left:50px;" class="current"  id="ESP8266 NONOS-SDK" onclick="showChildren('ESP8266 NONOS-SDK')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP8266 NONOS-SDK</a>
        </li>
        
        <div style="display:none" id="hidden_ESP8266 NONOS-SDK">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../nonos-sdk/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệu">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Cơ bản" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cơ bản </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bản">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/basic/" id="Cài đặt công cụ cần thiết">Cài đặt công cụ cần thiết </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/compile-first-time/" id="Biên dịch dự án mẫu">Biên dịch dự án mẫu </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/blink-led/" id="Bật tắt LED">Bật tắt LED </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/button/" id="Nút nhấn">Nút nhấn </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/uart/" id="UART">UART </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/complex-makefile/" id="Makefile cho dự án phức tạp">Makefile cho dự án phức tạp </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/task/" id="Task">Task </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/wifi/" id="Wifi">Wifi </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/espconn/" id="ESPCONN">ESPCONN </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/mdns/" id="MDNS">MDNS </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/ntp/" id="NTP">NTP </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../basic/save-to-flash/" id="Lưu dữ liệu vào Flash">Lưu dữ liệu vào Flash </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Smartconfig" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfig')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Smartconfig </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfig">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../smartconfig/smartconfig/" id="ESP8266 Smartconfig">ESP8266 Smartconfig </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../smartconfig/why-smartconfig/" id="Tại sao cần Smartconfig">Tại sao cần Smartconfig </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../smartconfig/esptouch/" id="ESPTOUCH & AIRKISS">ESPTOUCH & AIRKISS </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../smartconfig/wps/" id="WPS">WPS </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="MQTT" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTT')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  MQTT </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTT">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../mqtt/what-is-mqtt/" id="Giao thức MQTT">Giao thức MQTT </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../mqtt/mqtt-client/" id="ESP8266 MQTT Client">ESP8266 MQTT Client </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="HTTP Client" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP Client')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  HTTP Client </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP Client">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../http-client/http-client/" id="ESP8266 HTTP Client">ESP8266 HTTP Client </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="HTTP Server" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP Server')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  HTTP Server </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP Server">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../http-server/http-server/" id="ESP8266 HTTP Server">ESP8266 HTTP Server </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Firmware Over The Air" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The Air')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Firmware Over The Air </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The Air">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../fota/fota/" id="FOTA">FOTA </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="ESP Now" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP Now')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  ESP Now </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP Now">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../esp-now/esp-now/" id="ESP Now">ESP Now </a>
                </li>
            
            </div>
        
            <li class="current">
                <a style="padding-left:70px;" class="current"  id="ESP Mesh" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP NowESP Mesh')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  ESP Mesh </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP NowESP Mesh">
            
                <li class="current">
                    <a style="padding-left:90px;" class="current" href="./" id="ESP Mesh">ESP Mesh </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Các dự án" onclick="showChildren('ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP NowESP MeshCác dự án')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Các dự án </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 NONOS-SDKGiới thiệuCơ bảnSmartconfigMQTTHTTP ClientHTTP ServerFirmware Over The AirESP NowESP MeshCác dự án">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../projects/list/" id="Danh sách">Danh sách </a>
                </li>
            
            </div>
        
        </div>
    
        <li class="">
            <a style="padding-left:50px;" class=""  id="ESP8266 FreeRTOS-SDK" onclick="showChildren('ESP8266 FreeRTOS-SDK')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP8266 FreeRTOS-SDK</a>
        </li>
        
        <div style="display:none" id="hidden_ESP8266 FreeRTOS-SDK">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../freertos-sdk/freertos-sdk/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 FreeRTOS-SDKGiới thiệu">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Cơ bản" onclick="showChildren('ESP8266 FreeRTOS-SDKGiới thiệuCơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cơ bản </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 FreeRTOS-SDKGiới thiệuCơ bản">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../freertos-sdk/basic/introduction/" id="Cài đặt công cụ cần thiết">Cài đặt công cụ cần thiết </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../freertos-sdk/basic/basic-task/" id="Task cơ bản">Task cơ bản </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../freertos-sdk/basic/software-timer/" id="Software Timer">Software Timer </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../freertos-sdk/basic/queue-semaphore-mutex/" id="Đồng bộ / trao đổi dữ liệu">Đồng bộ / trao đổi dữ liệu </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../freertos-sdk/basic/task-notification/" id="Task notification">Task notification </a>
                </li>
            
            </div>
        
        </div>
    
        <li class="">
            <a style="padding-left:50px;" class=""  id="ESP8266 Arduino" onclick="showChildren('ESP8266 Arduino')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP8266 Arduino</a>
        </li>
        
        <div style="display:none" id="hidden_ESP8266 Arduino">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../arduino/arduino/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệu">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../arduino/esp8266-hardware/" id="Phần cứng ESP8266 Arduino">  Phần cứng ESP8266 Arduino </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 Arduino">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Cơ bản" onclick="showChildren('ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cơ bản </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bản">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/install/" id="Cài đặt">Cài đặt </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/digital/" id="Digital">Digital </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/analog/" id="Analog">Analog </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/timming-delay/" id="Thời gian & Delay">Thời gian & Delay </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/serial/" id="Serial">Serial </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/basic/progmem/" id="Progmem">Progmem </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Thư viện" onclick="showChildren('ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư viện')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Thư viện </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư viện">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/esp8266-wifi/" id="ESP8266WiFi">ESP8266WiFi </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/esp-api/" id="ESP-API">ESP-API </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/ticker/" id="Ticker">Ticker </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/eeprom/" id="EEPROM">EEPROM </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/i2c/" id="I2C (Thư viện Wire)">I2C (Thư viện Wire) </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/spi/" id="SPI">SPI </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/software-serial/" id="Software Serial">Software Serial </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/mdns-dnssd/" id="mDNS và DNS-SD">mDNS và DNS-SD </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/ssdp/" id="SSDP">SSDP </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/dns-server/" id="DNS Server">DNS Server </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/servo/" id="Servo">Servo </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/wifi-manager/" id="WiFiManager">WiFiManager </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/smartconfig-wps/" id="Smartconfig & WPS">Smartconfig & WPS </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/libraries/others/" id="Thư viện hữu ích khác">Thư viện hữu ích khác </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Filesystem" onclick="showChildren('ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystem')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Filesystem </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystem">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/filesystem/flash-layout/" id="Flash Layout">Flash Layout </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Cập nhật Firmware (FOTA)" onclick="showChildren('ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystemCập nhật Firmware (FOTA)')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cập nhật Firmware (FOTA) </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystemCập nhật Firmware (FOTA)">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/ota/arduino-fota/" id="Giới thiệu OTA">Giới thiệu OTA </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/ota/using-arduino-ide/" id="Sử dụng Arduino IDE">Sử dụng Arduino IDE </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/ota/using-web-browser/" id="Sử dụng trình duyệt">Sử dụng trình duyệt </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/ota/using-http-server/" id="Sử dụng HTTP Server">Sử dụng HTTP Server </a>
                </li>
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Các dự án" onclick="showChildren('ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystemCập nhật Firmware (FOTA)Các dự án')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Các dự án </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 ArduinoGiới thiệuPhần cứng ESP8266 ArduinoCơ bảnThư việnFilesystemCập nhật Firmware (FOTA)Các dự án">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/list/" id="Danh sách">Danh sách </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/smartconfig-react-native/" id="Smartconfig & react-native">Smartconfig & react-native </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/smartplug-slack/" id="Smart Plug & Slack Bot">Smart Plug & Slack Bot </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/thingspeak/" id="Đo nhiệt độ & độ ẩm (Thingspeak)">Đo nhiệt độ & độ ẩm (Thingspeak) </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/blynkled/" id="Ứng dụng Blynk điều khiển Led">Ứng dụng Blynk điều khiển Led </a>
                </li>
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../arduino/projects/blynkdht22/" id="Ứng dụng Blynk đo nhiệt độ,độ ẩm">Ứng dụng Blynk đo nhiệt độ,độ ẩm </a>
                </li>
            
            </div>
        
        </div>
    
        <li class="">
            <a style="padding-left:50px;" class=""  id="ESP8266 Micropython" onclick="showChildren('ESP8266 Micropython')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i> ESP8266 Micropython</a>
        </li>
        
        <div style="display:none" id="hidden_ESP8266 Micropython">
        
            <li class="">
                <a style="padding-left:70px;" class="" href="../../../micropython/micropython/" id="Giới thiệu">  Giới thiệu </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 MicropythonGiới thiệu">
            
            </div>
        
            <li class="">
                <a style="padding-left:70px;" class=""  id="Cơ bản" onclick="showChildren('ESP8266 MicropythonGiới thiệuCơ bản')"> <i class="fa fa-plus-square" style="padding-left:5px;font-size:13px;"></i>  Cơ bản </a>
                <!--  -->
            </li>
            
            <div style="display:none" id="hidden_ESP8266 MicropythonGiới thiệuCơ bản">
            
                <li class="">
                    <a style="padding-left:90px;" class="" href="../../../micropython/basic/introduction/" id="Cài đặt công cụ cần thiết">Cài đặt công cụ cần thiết </a>
                </li>
            
            </div>
        
        </div>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../projects/list/" id="Các dự án" style="font-size:95%;font-weight:bold;">Các dự án</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../license/" id="Bản quyền" style="font-size:95%;font-weight:bold;">Bản quyền</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
            <li><ul class="subnav">
    <li class="">
        <a class="" href="../../../contributor/" id="Đóng góp" style="font-size:95%;font-weight:bold;">Đóng góp</a>
    </li>
    
    <li class="paddingtop20"></li>
</ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../..">Internet Of Things (IoT) với ESP8266</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
    <ul class="wy-breadcrumbs">
        <li><a href="../../..">Docs</a> &raquo;</li>
          
        <li>ESP8266 NONOS-SDK &raquo;</li>
          
        <li>ESP Mesh &raquo;</li>
           
        <li>ESP Mesh</li>
        <li class="wy-breadcrumbs-aside">
             
                
            <a href="https://github.com/esp8266vn/esp8266.vn/tree/master/docs/nonos-sdk/esp-mesh/esp-mesh.md" class="icon icon-github"> Edit on GitHub</a>
                
             
        </li>
    </ul>
    <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <div class="toc">
<ul>
<li><a href="#gioi-thieu">Giới thiệu</a></li>
<li><a href="#mot-so-inh-nghia">Một số định nghĩa</a></li>
<li><a href="#cau-truc-mang">Cấu trúc mạng</a><ul>
<li><a href="#so-o-mang-mesh">Sơ đồ mạng mesh</a></li>
<li><a href="#cac-node-trong-mang">Các node trong mạng</a></li>
</ul>
</li>
<li><a href="#cac-header-trong-mesh">Các header trong Mesh</a></li>
<li><a href="#cau-truc-goi-tin">Cấu trúc gói tin</a></li>
<li><a href="#vi-du-goi-tin-gui-nhan">Ví dụ gói tin gửi/ nhận</a><ul>
<li><a href="#goi-tin-request">Gói tin request</a></li>
</ul>
</li>
<li><a href="#goi-tin-response">Gói tin response</a></li>
<li><a href="#cau-truc-du-lieu">Cấu trúc dữ liệu</a></li>
<li><a href="#chuong-trinh">Chương trình</a><ul>
<li><a href="#device">Device</a></li>
<li><a href="#mobile-hoac-server">Mobile hoặc Server</a></li>
</ul>
</li>
<li><a href="#lay-topology">Lấy topology</a></li>
<li><a href="#phan-tich-phan-hoi-tu-topology">Phân tích phản hồi từ topology</a></li>
<li><a href="#tham-khao">Tham khảo</a></li>
</ul>
</div>
<h1 id="gioi-thieu">Giới thiệu<a class="headerlink" href="#gioi-thieu" title="Permanent link">#</a></h1>
<p><img alt="Mesh Info" src="../../images/mesh-info.png" />
Trong quá trình phát triển IoT thường đòi hỏi việc tăng số lượng node kết nối với Internet.Nhược điểm lớn nhất là số lượng node có thể trực tiếp kết nối tới router bị giới hạn nhỏ hơn 32 node. Để khắc phục điểm này thì Espressif đã phát triển giao thức ESP-MESH. Trong giao thức này node có thể tạo ra mạng để chuyển tiếp gói tin, nhờ đó mà một số lượng lớn node có thể kết nối Internet mà không cần phải cải tiến, nâng cấp router.</p>
<h1 id="mot-so-inh-nghia">Một số định nghĩa<a class="headerlink" href="#mot-so-inh-nghia" title="Permanent link">#</a></h1>
<ul>
<li>IOT Espressif App: ứng dụng của Espressif dùng để điều khiển từ xa các thiết bị Wifi</li>
<li>ESP-Touch: công nghệ để kết nối Wifi device với router</li>
<li>Smart Config Mode cho ESP-Touch: cấu hình cho Wifi device dùng ESP-Touch thông qua Mode Smart Config.</li>
<li>
<p>Local Device: thiết bị được người dùng cấu hình kết nối với router thông qua ESP-Touch mà không kích hoạt trên server, chỉ có thể điều khiển thông qua mạng cục bộ
<img alt="Local NetWork" src="../../images/local-network.png" /></p>
</li>
<li>
<p>Cloud Device: giống như Local Device nhưng được kích hoạt trên server, có thể điều khiển ở mọi nơi có mạng internet.
<img alt="Cloud NetWork" src="../../images/cloud-network.png" /></p>
</li>
</ul>
<h1 id="cau-truc-mang">Cấu trúc mạng<a class="headerlink" href="#cau-truc-mang" title="Permanent link">#</a></h1>
<p>Mạng Mesh hỗ trợ chức năng auto-networking. Khi người dùng thiết lập mạng mesh thông qua ESP-Touch thì thiết bị sẽ tự động tìm các Wifi AP gần kề.</p>
<h2 id="so-o-mang-mesh">Sơ đồ mạng mesh<a class="headerlink" href="#so-o-mang-mesh" title="Permanent link">#</a></h2>
<p><img alt="Mesh NetWork" src="../../images/mesh-network.png" /></p>
<ul>
<li>Các node sẽ kết nối trực tiếp tới router được gọi là root node, các node khác thì được gọi là non-root node.</li>
<li>Online-Mesh: Khi router kết nối với internet thì ta có thể dùng IOT App để điều khiển từ xa ở bất kỳ đâu</li>
<li>Local-Mesh: Bạn chỉ có thể điều khiển Local Device trong mạng thông qua router.</li>
</ul>
<h2 id="cac-node-trong-mang">Các node trong mạng<a class="headerlink" href="#cac-node-trong-mang" title="Permanent link">#</a></h2>
<ul>
<li>Root Node<ul>
<li>Nhận và gửi gói tin</li>
<li>Chuyển tiếp gói tin từ server, ứng dụng mobile và các node con của nó</li>
</ul>
</li>
<li>None-root Node<ul>
<li>Non-leaf node: Nhận và gửi gói tin, chuyển tiếp gói tin từ node cha và các node con khác</li>
<li>Leaf node: Chỉ được nhận và gửi gói tin, không có chức năng chuyển tiếp.</li>
</ul>
</li>
</ul>
<h1 id="cac-header-trong-mesh">Các header trong Mesh<a class="headerlink" href="#cac-header-trong-mesh" title="Permanent link">#</a></h1>
<p><img alt="Mesh Header" src="../../images/mesh-header.png" /></p>
<p>Mô tả</p>
<table>
<thead>
<tr>
<th>Tên trường</th>
<th>Độ dài</th>
<th>Mô tả</th>
</tr>
</thead>
<tbody>
<tr>
<td>ver</td>
<td>2 bit</td>
<td>Thông tin Mesh</td>
</tr>
<tr>
<td>o</td>
<td>1 bit</td>
<td>Tùy chọn flag</td>
</tr>
<tr>
<td>flags</td>
<td>5 bit</td>
<td>FP</td>
</tr>
<tr>
<td></td>
<td>FP</td>
<td>Cho phép Piggyback flow trong gói tin</td>
</tr>
<tr>
<td></td>
<td>FR</td>
<td>Yêu cầu,Piggyback flow trong gói tin</td>
</tr>
<tr>
<td></td>
<td>resv</td>
<td>Dự phòng</td>
</tr>
<tr>
<td></td>
<td>8 bit</td>
<td>D</td>
</tr>
<tr>
<td></td>
<td>D</td>
<td>Chiều của gói tin: 0: xuống (downward) 1: lên (upward)</td>
</tr>
<tr>
<td></td>
<td>P2P</td>
<td>Gói tin từ Node tới Node</td>
</tr>
<tr>
<td></td>
<td>protocol</td>
<td>Giao thức gửi dữ liệu được quy định bởi người dùng(6bit)</td>
</tr>
<tr>
<td>len</td>
<td>2 byte</td>
<td>Chiều dài của gói tin (bao gồm cả mesh header)</td>
</tr>
<tr>
<td>dst_addr</td>
<td>6 bytes</td>
<td>Địa chỉ đích</td>
</tr>
<tr>
<td>src_addr</td>
<td>6 bytes</td>
<td>Địa chỉ nguồn</td>
</tr>
<tr>
<td>ot_len</td>
<td></td>
<td>Độ dài của option (gồm cả chính nó)</td>
</tr>
<tr>
<td>option_list</td>
<td></td>
<td>Danh sách các thành phần của các option</td>
</tr>
<tr>
<td>otype</td>
<td>1 byte</td>
<td>Kiểu option</td>
</tr>
<tr>
<td>olen</td>
<td>1 byte</td>
<td>Chiều dài của option hiện tịa</td>
</tr>
<tr>
<td>ovalue</td>
<td>Người dùng định nghĩa</td>
<td>Giá trị option hiện tại</td>
</tr>
</tbody>
</table>
<h1 id="cau-truc-goi-tin">Cấu trúc gói tin<a class="headerlink" href="#cau-truc-goi-tin" title="Permanent link">#</a></h1>
<p>Mạng mesh được định nghĩa bởi cấu trúc trong mesh_option_type</p>
<pre><code>    enum mesh_option_type {
    M_O_FLOW_REQ = 0,   //flow request option
    M_O_FLOW_RESP,      //flow response option
    M_O_ROUTER_SPREAD,  //router information spread option
    M_O_ROUTE_ADD,      //route table update (node joins mesh) option
    M_O_ROUTE_DEL,      //route table update (node exits mesh) option
    M_O_TOPO_REQ,       //topology request option
    M_O_TOPO_RESP,      //topology response option
    M_O_MCAST_GRP,      //group list of mcast
    M_O_MESH_FRAG,      //mesh management fragmentation option
    M_O_USR_FRAG,       //user data fragmentation
    M_O_USR_OPTION,     //user option
    };
</code></pre>

<table>
<thead>
<tr>
<th>Tên trường</th>
<th>Độ dài</th>
<th>Mô tả</th>
<th>Định dạng</th>
</tr>
</thead>
<tbody>
<tr>
<td>M_O_FLOW_REQ</td>
<td>2 Bytes</td>
<td>Dùng cho flow request</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_FLOW_RESP</td>
<td>6 Bytes</td>
<td>Dùng cho phản hồi tới flow</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_ROUTER_SPREAD</td>
<td>106 Bytes</td>
<td>Dùng spread thông tin từ router</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_ROUTE_ADD</td>
<td>6*n+2Bytes</td>
<td>Dùng để cập nhật bảng định tuyến khi có node mới tham gia vào mạng</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_ROUTE_DEL</td>
<td>6*n+2Bytes</td>
<td>Dùng để cập nhật bảng định tuyến khi có node rời mạng</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_TOPO_REQ</td>
<td>8 Bytes</td>
<td>Sử dụng để lấy topo của mạng mesh</td>
<td>otype</td>
</tr>
<tr>
<td>M_O_TOPO_RESP</td>
<td>6*n+2Bytes</td>
<td>Sử dụng để nhận phản hồi topo của mạng mesh</td>
<td>otype</td>
</tr>
</tbody>
</table>
<h1 id="vi-du-goi-tin-gui-nhan">Ví dụ gói tin gửi/ nhận<a class="headerlink" href="#vi-du-goi-tin-gui-nhan" title="Permanent link">#</a></h1>
<h3 id="goi-tin-request">Gói tin request<a class="headerlink" href="#goi-tin-request" title="Permanent link">#</a></h3>
<table>
<thead>
<tr>
<th></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
</tr>
</thead>
<tbody>
<tr>
<td>00000000h</td>
<td>04</td>
<td>01</td>
<td>14</td>
<td>00</td>
<td>18</td>
<td>FE</td>
<td>34</td>
<td>A5</td>
<td>3B</td>
<td>AD</td>
<td>18</td>
<td>FE</td>
<td>34</td>
<td>A2</td>
<td>C7</td>
<td>76</td>
</tr>
<tr>
<td>00000010h</td>
<td>04</td>
<td>00</td>
<td>00</td>
<td>02</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Mô tả</p>
<table>
<thead>
<tr>
<th>Tên trường</th>
<th>Giá trị</th>
<th>Mô tả</th>
</tr>
</thead>
<tbody>
<tr>
<td>head.ver</td>
<td>00</td>
<td>Phiên bản hiện tại của mesh là 00</td>
</tr>
<tr>
<td>head.O</td>
<td>1</td>
<td>Có option trong gói tin</td>
</tr>
<tr>
<td>head.flags.FP</td>
<td>0</td>
<td>Không có piggyback flow permit</td>
</tr>
<tr>
<td>head.flags.FR</td>
<td>0</td>
<td>Không có piggyback flow request</td>
</tr>
<tr>
<td>head.flags.resv</td>
<td>000</td>
<td>Dự phòng</td>
</tr>
<tr>
<td>head.proto.D</td>
<td>1</td>
<td>Upwards</td>
</tr>
<tr>
<td>head.proto.P2P</td>
<td>0</td>
<td>Không có gói từ node tới node</td>
</tr>
<tr>
<td>head.proto.protocol</td>
<td>000000</td>
<td>Gói tin quản lý mesh</td>
</tr>
<tr>
<td>head.len</td>
<td>0x0014</td>
<td>Chiều dài của gói tin là 20 byte</td>
</tr>
<tr>
<td>head.dst_addr</td>
<td>18 FE 34 A5 3B AD</td>
<td>Địa chỉ MAC của destination device</td>
</tr>
<tr>
<td>head.src_addr</td>
<td>18 FE 34 A2 C7 76</td>
<td>Địa chỉ MAC của source device</td>
</tr>
<tr>
<td>head.ot_len</td>
<td>0x0004</td>
<td>Chiều dài của option là 0x0004</td>
</tr>
<tr>
<td>head.option_list[0].otype</td>
<td>0x00</td>
<td>M_FLOW_REQ</td>
</tr>
<tr>
<td>head.option_list[0].olen</td>
<td>0x02</td>
<td>Option length là 0x02</td>
</tr>
</tbody>
</table>
<h1 id="goi-tin-response">Gói tin response<a class="headerlink" href="#goi-tin-response" title="Permanent link">#</a></h1>
<table>
<thead>
<tr>
<th></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>a</th>
<th>b</th>
<th>c</th>
<th>d</th>
<th>e</th>
<th>f</th>
</tr>
</thead>
<tbody>
<tr>
<td>00000000h</td>
<td>04</td>
<td>00</td>
<td>18</td>
<td>00</td>
<td>18</td>
<td>FE</td>
<td>34</td>
<td>A2</td>
<td>C7</td>
<td>76</td>
<td>18</td>
<td>FE</td>
<td>34</td>
<td>A5</td>
<td>3B</td>
<td>AD</td>
</tr>
<tr>
<td>00000010h</td>
<td>08</td>
<td>00</td>
<td>01</td>
<td>06</td>
<td>01</td>
<td>00</td>
<td>00</td>
<td>00</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Mô tả</p>
<table>
<thead>
<tr>
<th>Tên trường</th>
<th>Giá trị</th>
<th>Mô tả</th>
</tr>
</thead>
<tbody>
<tr>
<td>head.ver</td>
<td>00</td>
<td>Phiên bản hiện tại của mesh là 00</td>
</tr>
<tr>
<td>head.O</td>
<td>1</td>
<td>Có option trong gói tin</td>
</tr>
<tr>
<td>head.flags.FP</td>
<td>0</td>
<td>Không có piggyback flow permit</td>
</tr>
<tr>
<td>head.flags.FR</td>
<td>0</td>
<td>Không có piggyback flow request</td>
</tr>
<tr>
<td>head.flags.resv</td>
<td>000</td>
<td>Dự phòng</td>
</tr>
<tr>
<td>head.proto.D</td>
<td>0</td>
<td>Downwards.</td>
</tr>
<tr>
<td>head.proto.P2P</td>
<td>0</td>
<td>Không có gói từ node tới node</td>
</tr>
<tr>
<td>head.proto.protocol</td>
<td>000000</td>
<td>Gói tin quản lý mesh</td>
</tr>
<tr>
<td>head.len</td>
<td>0x0015</td>
<td>Chiều dài của gói tin là 21 byte</td>
</tr>
<tr>
<td>head.dst_addr</td>
<td>18 FE 34 A2 C7 76</td>
<td>Địa chỉ MAC của destination device</td>
</tr>
<tr>
<td>head.src_addr</td>
<td>18 FE 34 A5 3B AD</td>
<td>Địa chỉ MAC của source device</td>
</tr>
<tr>
<td>head.ot_len</td>
<td>0x0008</td>
<td>Chiều dài của option là 0x0008</td>
</tr>
<tr>
<td>head.option_list[0].otype</td>
<td>0x01</td>
<td>M_FLOW_RESP</td>
</tr>
<tr>
<td>head.option_list[0].olen</td>
<td>0x06</td>
<td>Option length là 0x06</td>
</tr>
<tr>
<td>head.option_list[0].ovalue</td>
<td>0x01</td>
<td>Option value là 0x00000001, flow capacity là 0x00000001.</td>
</tr>
</tbody>
</table>
<h1 id="cau-truc-du-lieu">Cấu trúc dữ liệu<a class="headerlink" href="#cau-truc-du-lieu" title="Permanent link">#</a></h1>
<ul>
<li>Định dạng mesh header </li>
</ul>
<pre><code>struct mesh_header_format {
    uint8_t ver: 2; // version of mesh
    uint8_t oe: 1; // option flag
    uint8_t fp: 1; // piggyback flow permit in packet
    uint8_t fr: 1; // piggyback flow request in packet
    uint8_t rsv: 3; // reserved
    struct {
        uint8_t d: 1; // direction, 1:upwards, 0:downwards
        uint8_t p2p: 1; // node to node packet
        uint8_t protocol: 6; // protocol used by user data
    } proto;
    uint16_t len; // packet total length
    (mesh header included)
    uint8_t dst_addr[ESP_MESH_ADDR_LEN]; // destination address
    uint8_t src_addr[ESP_MESH_ADDR_LEN]; // source address
    struct mesh_header_option_header_type option[0]; // mesh option
} __packed;
</code></pre>

<ul>
<li>Định dạng mesh Option header </li>
</ul>
<pre><code>struct mesh_header_option_header_type {
    uint16_t ot_len; // option total length
    struct mesh_header_option_format olist[0]; // option list
} __packed;
</code></pre>

<ul>
<li>Định dạng mesh Option </li>
</ul>
<pre><code>struct mesh_header_option_format {
    uint8_t otype; // option type
    uint8_t olen; // current option length
    uint8_t ovalue[0]; // option value
} __packed;
</code></pre>

<ul>
<li>Định dạng mesh Option Fragmentation</li>
</ul>
<pre><code>struct mesh_header_option_frag_format {
    uint16_t id; // identity of fragmentation
    struct {
        uint16_t resv: 1; // reserved
        uint16_t mf: 1; // more fragmentation
        uint16_t idx: 14; // fragmentation offset
    } offset;
} __packed;
</code></pre>

<ul>
<li>Định dạng Mesh Callback</li>
</ul>
<pre><code>typedef void (* espconn_mesh_callback)(int8_t result);
</code></pre>

<ul>
<li>Định dạng Mesh Scan Callback</li>
</ul>
<pre><code>typedef void (* espconn_mesh_scan_callback)(void *arg, int8_t
status);
</code></pre>

<ul>
<li>Định dạng Mesh Scan User Callback</li>
</ul>
<pre><code>typedef void (* espconn_mesh_usr_callback)(void *arg);
</code></pre>

<div class="admonition note">
<p class="admonition-title">Lưu ý</p>
<p>Các API của packet có thể tham khảo tại <a href="http://www.espressif.com/en/support/download/documents#overlay=en/admin/content">API</a></p>
</div>
<h1 id="chuong-trinh">Chương trình<a class="headerlink" href="#chuong-trinh" title="Permanent link">#</a></h1>
<h2 id="device">Device<a class="headerlink" href="#device" title="Permanent link">#</a></h2>
<h2 id="mobile-hoac-server">Mobile hoặc Server<a class="headerlink" href="#mobile-hoac-server" title="Permanent link">#</a></h2>
<pre><code>void controller_entrance(Parameter list)
{
    /*Add your codes to check status*/
    /*Add your codes to build control packet*/
    uint8_t json_control_data[] = {/*Add your codes*/};
    uint16_t control_data_len = sizeof(json_control_data)
                                struct mesh_header_format * mesh_header = NULL;
    /* src_addr should be the combination of IP and port of
    Mobile or Server. You can set the address to zero, then the
    root device will fill in the section. If you fill in the
    section by yourself, please make sure the value is right.*/
    uint8_t src_addr[] = {0, 0, 0, 0, 0, 0},
                         dst_addr[] = {xx, xx, xx, xx, xx, xx};
    mesh_header = (struct mesh_header_format
                   *)espconn_mesh_create_packet(dst_addr, src_addr, false, true,
                           M_PROTO_JSON, control_data_len,
                           false, 0, false, 0, false, 0, 0);
    if (!mesh_header)
    {
        printf(“alloc resp packet fail\n”);
        return;
    }
    if (espconn_mesh_set_usr_data(mesh_header,
                                  resp_json_packet_body, resp_data_len))
    {
        printf(“set user data fail\n”);
        free(mesh_header);
        return;
    }
// sent control packet
    espconn_mesh_sent(esp, mesh_header, mesh_header-&gt;len);
    free(mesh_header);
}
</code></pre>

<h1 id="lay-topology">Lấy topology<a class="headerlink" href="#lay-topology" title="Permanent link">#</a></h1>
<pre><code>void topology_entrance(Parameter list)
{
    /*Add your codes to check status*/
    /*Add your codes to build getting topology packet*/
    bool res;
    struct mesh_header_format *mesh_header = NULL;
    struct mesh_header_option_format *topo_option = NULL;
    uint8_t src_addr[] = {0, 0, 0, 0, 0, 0};
    uint8_t dst_addr[] = {xx, xx, xx, xx, xx, xx}; // MAC address of root
    device
    uint8_t dev_mac[6] = {xx, xx, xx, xx, xx, xx}; // zero represents
    topology of all devices
    uint16_t ot_len = sizeof(*topo_option) + sizeof(struct
                      mesh_header_option_header_type) + sizeof(dev_mac);
    mesh_header = (struct mesh_header_format
                   *)espconn_mesh_create_packet(
                      dst_addr, src_addr, false, true, M_PROTO_NONE, 0,
                      true, ot_len, false, 0, false, 0, 0);
    if (!mesh_header) {
        printf(“alloc resp packet fail\n”);
        return;
    }
    topo_option = (struct mesh_header_option_format
                   *)espconn_mesh_create_option(
                      M_O_TOPO_REQ, dev_mac, sizeof(dev_mac));
    if (!topo_option) {
        printf(“alloc topo option fail\n”);
        free(mesh_header);
        return;
    }
    res = espconn_mesh_add_option(mesh_header, topo_option);
    free(topo_option);
    if (res) {
        printf(“add topo option fail\n”);
        free(mesh_header);
        return;
    }
// send packet of getting topology
    espconn_mesh_sent(esp, mesh_header, mesh_header-&gt;len);
    free(mesh_header);
}
</code></pre>

<h1 id="phan-tich-phan-hoi-tu-topology">Phân tích phản hồi từ topology<a class="headerlink" href="#phan-tich-phan-hoi-tu-topology" title="Permanent link">#</a></h1>
<pre><code>void topology_parser_entrance(uint8_t *topo_resp, uint16_t len)
{
    /*Add your codes to check parameter*/
    uint16_t oidx = 1;
    struct mesh_header_format *mesh_header = NULL;
    struct mesh_header_option_format *topo_option = NULL;
    mesh_header = (struct mesh_header_format *)topo_resp;
    if (!mesh_header-&gt;oe) {
        printf(“no option exist\n”);
        return;
    }
    /* you need parse all the options one by one in the packet header
    */
    while (espconn_mesh_get_option(mesh_header, M_O_TOPO_RESP,
                                   oidx++, &amp;topo_option)) {
        uint16_t dev_count = topo_option-&gt;olen / 6;
        process_dev_list(topo_option-&gt;ovalue, dev_count);
    }
}
</code></pre>

<h1 id="tham-khao">Tham khảo<a class="headerlink" href="#tham-khao" title="Permanent link">#</a></h1>
<ul>
<li><a href="https://espressif.com/en/products/software/esp-mesh/overview">ESP-MESH</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../projects/list/" class="btn btn-neutral float-right" title="Danh sách">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../esp-now/esp-now/" class="btn btn-neutral" title="ESP Now"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2016 <a href="https://esp8266.vn">ESP8266 Viet Nam</a> - Tài trợ bởi <a href="https://iotmaker.vn">IoT Maker Viet Nam</a></p>
    
  </div>

  
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<!-- <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/esp8266vn/esp8266.vn" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../../esp-now/esp-now/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../projects/list/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div> -->

<script type="text/javascript">
  // If cookie is defined toggle the id
  if (typeof $.cookie('docToggle') !== 'undefined') {
      // Parse cookie which is an array
      var _parsed_cookie = JSON.parse($.cookie('docToggle'));
      // Loop over array and show hidden divs
      $.each(_parsed_cookie, function(index, value) {
          // Toggle
          $("[id='hidden_" + value + "']").css('display','');
      })
  }
</script>

</body>
</html>